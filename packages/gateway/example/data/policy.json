[
  {
    "name": "AdminAccess",
    "statements": [
      {
        "effect": "allow",
        "when": "onReceive",
        "resources": [
          {
            "pattern": "/admin/*",
            "actions": [
              "GET",
              "POST",
              "DELETE",
              "PUT",
              "PATCH"
            ],
            "conditions": [
              {
                "fn::contains": [
                  {
                    "path": "roles",
                    "in": "jwtToken"
                  },
                  "Admin"
                ]
              }
            ]
          }
        ]
      }
    ]
  },
  {
    "name" : "StandardAccess",
    "statements" : [
      {
        "effect" : "allow",
        "when" : "onReceive",
        "resources" : [
          {
            "pattern" : "/paper-service/papers",
            "actions" : [
              "POST"
            ],
            "conditions" : [
              {
                "fn::equal" : [
                  {
                    "path" : "username",
                    "in" : "jwtToken"
                  },
                  {
                    "path" : "author",
                    "in" : "payload"
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "effect" : "allow",
        "when" : "onReturn",
        "resources" : [
          {
            "pattern" : "/paper-service/papers",
            "actions" : [
              "GET"
            ],
            "conditions" : [
              {
                "fn::equal" : [
                  {
                    "path" : "username",
                    "in" : "jwtToken"
                  },
                  {
                    "path" : "author",
                    "in" : "payload"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
]
