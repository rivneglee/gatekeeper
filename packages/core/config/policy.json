{
  "version": "1.0.0",
  "statements": [
    {
      "effect": "allow",
      "when": "onReceive",
      "resources": [
        {
          "pattern": "/papers/:paper-id/commits",
          "actions": ["GET"],
          "conditions": [
            {
              "fn::or": [
                {
                  "fn::and": [
                    {
                      "fn::not": [
                        {"path": "status", "in": "jwtToken"},
                        "inactive"
                      ]
                    },
                    {
                      "fn::equal": [
                        {"path": "userId", "in": "tags"},
                        {"path": "userId", "in": "jwtToken"}
                      ]
                    }
                  ]
                },
                {
                  "fn::equal": [
                    {"path": "isAdmin", "in": "jwtToken"},
                    true
                  ]
                }
              ]
            }
          ]
        },
        {
          "pattern": "/papers",
          "actions": ["POST"],
          "conditions": [
            {
              "fn::equal": [
                {"path": "userId", "in": "jwtToken"},
                {"path": "author", "in": "payload"}
              ]
            }
          ]
        }
      ]
    }
  ]
}
